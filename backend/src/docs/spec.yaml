openapi: 3.0.0
info:
  title: LibraManager API
  version: 1.0.0
  description: REST API для управления библиотекой.
servers:
  - url: http://localhost:8080/
tags:
  - name: Регистрация
    description: Методы для регистрации сотрудников
  - name: Авторизация
    description: Методы для входа сотрудников
  - name: Профиль
    description: Управление профилем сотрудника
  - name: Книги
    description: Управление книгами из библиотечного фонда
  - name: Читатели
    description: Управление читателями библиотеки
  - name: Залы
    description: Управление залами билиотеки
  - name: Выдачи
    description: Управление вадачами книг читателям билиотеки

paths:
  /register:
    post:
      summary: Регистрация библиотекаря
      tags:
        - Регистрация
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                full_name:
                  type: string
                  example: Иванова Александра Евгеньевна
                email:
                  type: string
                  format: email
                  description: Адрес электронной почты библиотекаря
                  example: ivan.petrov@example.com
                password:
                  type: string
                  format: password
                  description: Пароль библиотекаря
                  example: SecureP@ssword123
      responses:
        '201':
          description: Библиотекарь успешно зарегистрирован
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    description: Сообщение успеха
                    example: Библиотекарь успешно зарегистрирован
        '400':
          description: Некорректные входные данные
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Описание ошибки
                    example: Некорректный формат ввода
        '500':
          description: Внутренняя ошибка сервера
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Сообщение об ошибке
                    example: Произошла внутренняя ошибка сервера

  /login:
    post:
      summary: Аутентификация библиотекаря
      tags:
        - Авторизация
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  format: email
                  description: Электронная почта библиотекаря
                  example: alexander.sidorov@example.com
                password:
                  type: string
                  format: password
                  description: Пароль библиотекаря
                  example: SecurePassw0rd123
      responses:
        '200':
          description: Успешная аутентификация
          content:
            application/json:
              schema:
                type: object
                properties:
                  token:
                    type: string
                    description: JWT-токен для дальнейшей авторизации
                    example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
        '404':
          description: Пользователь не найден
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Ошибка авторизации
                    example: Библиотекарь не найден
        '400':
          description: Неверный пароль
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Ошибка авторизации
                    example: Неверный пароль
        '500':
          description: Внутренняя ошибка сервера
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Сообщение об ошибке
                    example: Произошла внутренняя ошибка сервера

  /librarian/:librarian_id:
    get:
      summary: Профиль текущего библиотекаря
      security:
        - bearerAuth: []
      tags:
        - Профиль
      parameters:
        - in: path
          name: librarian_id
          required: true
          schema:
            type: integer
          description: Идентификатор библиотекаря
      responses:
        '200':
          description: Данные текущего библиотекаря
          content:
            application/json:
              schema:
                type: object
                properties:
                  librarian_id:
                    type: integer
                    description: Уникальный идентификатор библиотекаря
                  full_name:
                    type: string
                    description: Полное имя библиотекаря
                  email:
                    type: string
                    format: email
                    description: Электронный адрес библиотекаря
        '401':
          description: Нет доступа к ресурсу
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Ошибка доступа
                    example: Недостаточно прав для просмотра данных
        '404':
          description: Библиотекарь не найден
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Ошибка отсутствия данных
                    example: Библиотекарь не найден
        '500':
          description: Внутренняя ошибка сервера
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Сообщение об ошибке
                    example: Произошла внутренняя ошибка сервера

  /librarian/all:
    get:
      summary: Профили всех библиотекарей
      security:
        - bearerAuth: []
      tags:
        - Профиль
      responses:
        '200':
          description: Список всех библиотекарей
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    librarian_id:
                      type: integer
                      description: Уникальный идентификатор библиотекаря
                    full_name:
                      type: string
                      description: Полное имя библиотекаря
                    email:
                      type: string
                      format: email
                      description: Электронный адрес библиотекаря
                    role:
                      type: string
                      description: Роль библиотекаря
        '403':
          description: Недоступно для текущих полномочий
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Описание ошибки
                    example: Доступ запрещен
        '500':
          description: Внутренняя ошибка сервера
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Сообщение об ошибке
                    example: Произошла внутренняя ошибка сервера

  /librarian/delete/:librarian_id:
    delete:
      summary: Удаление профиля библиотекаря
      security:
        - bearerAuth: []
      tags:
        - Профиль
      parameters:
        - in: path
          name: librarian_id
          required: true
          schema:
            type: integer
          description: Уникальный идентификатор библиотекаря
      responses:
        '200':
          description: Пользователь успешно удалён
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    description: Подтверждение успешного удаления
                    example: Аккаунт успешно удалён.
        '401':
          description: Нет доступа к ресурсу
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Ошибка доступа
                    example: Нет необходимых прав для выполнения данной операции
        '404':
          description: Библиотекарь не найден
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Ошибка отсутствия данных
                    example: Библиотекарь не найден
        '500':
          description: Внутренняя ошибка сервера
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Сообщение об ошибке
                    example: Произошла внутренняя ошибка сервера

  /librarian/edit/:librarian_id:
    patch:
      summary: Редактирование профиля библиотекаря
      security:
        - bearerAuth: []
      tags:
        - Профиль
      parameters:
        - in: path
          name: librarian_id
          required: true
          schema:
            type: integer
          description: Уникальный идентификатор библиотекаря
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                full_name:
                  type: string
                  maxLength: 60
                  description: Новое имя библиотекаря
                email:
                  type: string
                  format: email
                  maxLength: 30
                  description: Новый электронный адрес библиотекаря
                role:
                  type: string
                  maxLength: 20
                  description: Новая роль библиотекаря
      responses:
        '200':
          description: Профиль успешно обновлён
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    description: Подтверждение успешного обновления
                    example: Профиль успешно обновлен.
        '401':
          description: Нет доступа к ресурсу
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Ошибка доступа
                    example: Нет необходимых прав для выполнения данной операции
        '403':
          description: Доступ запрещён
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Ошибка доступа
                    example: Доступ запрещён.
        '404':
          description: Библиотекарь не найден
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Ошибка отсутствия данных
                    example: Библиотекарь не найден
        '500':
          description: Внутренняя ошибка сервера
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Сообщение об ошибке
                    example: Произошла внутренняя ошибка сервера

  /books/create:
    post:
      summary: Добавление новой книги
      security:
        - bearerAuth: []
      tags:
          - Книги
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                title:
                  type: string
                  description: Название книги
                  minLength: 1
                publish_year:
                  type: integer
                  minimum: 1500
                  maximum: 2025
                  description: Год выпуска книги
                isbn:
                  type: string
                  pattern: "^\\d{3}-\\d-\\d{9}-\\d$|^\\d{9}(\\d|X)$"
                  description: Международный стандартный номер книги (ISBN)
                code:
                  type: string
                  description: Шифр книги
                date_added:
                  type: string
                  format: date-time
                  description: Дата добавления книги
                quantity:
                  type: integer
                  minimum: 1
                  maximum: 100
                  description: Количество копий книги
                authors:
                  type: array
                  items:
                    type: object
                    properties:
                      surname:
                        type: string
                        description: Фамилия автора
                      name:
                        type: string
                        description: Имя автора
                      patronymic:
                        type: string
                        nullable: true
                        description: Отчество автора
      responses:
        '201':
          description: Книга успешно добавлена
          content:
            text/plain:
              schema:
                type: string
                example: Книга успешно добавлена.
        '400':
          description: Некорректные входные данные
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Описание ошибки
                    example: Название книги обязательно.
        '403':
          description: Недостаточно прав для добавления книги
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Описание ошибки
                    example: Доступ запрещен.
        '500':
          description: Внутренняя ошибка сервера
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Сообщение об ошибке
                    example: Произошла внутренняя ошибка сервера.

  /books/get/:book_id:
    get:
      summary: Информация о книге по её идентификатору
      security:
        - bearerAuth: []
      tags:
        - Книги
      parameters:
        - in: path
          name: book_id
          required: true
          schema:
            type: integer
          description: Идентификатор книги
      responses:
        '200':
          description: Информация о книге
          content:
            application/json:
              schema:
                type: object
                properties:
                  book_id:
                    type: integer
                    description: Уникальный идентификатор книги
                  title:
                    type: string
                    description: Название книги
                  publish_year:
                    type: integer
                    description: Год издания книги
                  isbn:
                    type: string
                    description: Международный стандартный номер книги (ISBN)
                  code:
                    type: string
                    description: Каталогизационный шифр книги
                  date_added:
                    type: string
                    format: date-time
                    description: Дата добавления книги в базу данных
                  quantity:
                    type: integer
                    description: Количество экземпляров книги
                  Authors:
                    type: array
                    items:
                      type: object
                      properties:
                        author_id:
                          type: integer
                          description: Уникальный идентификатор автора
                        surname:
                          type: string
                          description: Фамилия автора
                        name:
                          type: string
                          description: Имя автора
                        patronymic:
                          type: string
                          nullable: true
                          description: Отчество автора
        '404':
          description: Книга не найдена
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Описание ошибки
                    example: Книга не найдена
        '500':
          description: Внутренняя ошибка сервера
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Сообщение об ошибке
                    example: Произошла внутренняя ошибка сервера

  /books/all:
    get:
      summary: Список всех книг
      security:
        - bearerAuth: []
      tags:
        - Книги
      responses:
        '200':
          description: Список всех книг
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    book_id:
                      type: integer
                      description: Уникальный идентификатор книги
                    title:
                      type: string
                      description: Название книги
                    publish_year:
                      type: integer
                      description: Год издания книги
                    isbn:
                      type: string
                      description: Международный стандартный номер книги (ISBN)
                    code:
                      type: string
                      description: Каталогизационный шифр книги
                    date_added:
                      type: string
                      format: date-time
                      description: Дата добавления книги в базу данных
                    quantity:
                      type: integer
                      description: Количество экземпляров книги
                    Authors:
                      type: array
                      items:
                        type: object
                        properties:
                          author_id:
                            type: integer
                            description: Уникальный идентификатор автора
                          surname:
                            type: string
                            description: Фамилия автора
                          name:
                            type: string
                            description: Имя автора
                          patronymic:
                            type: string
                            nullable: true
                            description: Отчество автора
        '500':
          description: Внутренняя ошибка сервера
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Сообщение об ошибке
                    example: Произошла внутренняя ошибка сервера

  /books/edit/:book_id:
    patch:
      summary: Редактирование информации о книге
      security:
        - bearerAuth: []
      tags:
        - Книги
      parameters:
        - in: path
          name: book_id
          required: true
          schema:
            type: integer
          description: Идентификатор книги
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                title:
                  type: string
                  description: Новое название книги
                  minLength: 1
                publish_year:
                  type: integer
                  minimum: 1500
                  maximum: 2025
                  description: Новый год выпуска книги
                isbn:
                  type: string
                  pattern: "^\\d{3}-\\d-\\d{9}-\\d$|^\\d{9}(\\d|X)$"
                  description: Новый международный стандартный номер книги (ISBN)
                code:
                  type: string
                  description: Новый шифр книги
                quantity:
                  type: integer
                  minimum: 1
                  maximum: 100
                  description: Новое количество экземпляров книги
                authors:
                  type: array
                  items:
                    type: object
                    properties:
                      surname:
                        type: string
                        description: Фамилия автора
                      name:
                        type: string
                        description: Имя автора
                      patronymic:
                        type: string
                        nullable: true
                        description: Отчество автора
      responses:
        '200':
          description: Книга успешно обновлена
          content:
            text/plain:
              schema:
                type: string
                example: Книга успешно обновлена.
        '403':
          description: Недостаточно прав для редактирования книги
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Описание ошибки
                    example: Доступ запрещен.
        '404':
          description: Книга не найдена
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Описание ошибки
                    example: Книга не найдена.
        '500':
          description: Внутренняя ошибка сервера
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Сообщение об ошибке
                    example: Произошла внутренняя ошибка сервера.

  /books/delete/:book_id:
    delete:
      summary: Удаление книги по идентификатору
      security:
        - bearerAuth: []
      tags:
        - Книги
      parameters:
        - in: path
          name: book_id
          required: true
          schema:
            type: integer
          description: Идентификатор книги
      responses:
        '200':
          description: Книга успешно удалена
          content:
            text/plain:
              schema:
                type: string
                example: Книга успешно удалена.
        '403':
          description: Недостаточно прав для удаления книги
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Описание ошибки
                    example: Доступ запрещен.
        '404':
          description: Книга не найдена
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Описание ошибки
                    example: Книга не найдена.
        '500':
          description: Внутренняя ошибка сервера
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Сообщение об ошибке
                    example: Произошла внутренняя ошибка сервера.

  /readers/add:
    post:
      summary: Регистрация нового читателя
      security:
        - bearerAuth: []
      tags:
        - Читатели
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  description: ФИО читателя
                  minLength: 1
                card_number:
                  type: string
                  description: Номер читательского билета
                  minLength: 1
                birth_date:
                  type: string
                  format: date
                  description: Дата рождения читателя
                phone:
                  type: string
                  description: Телефон читателя
                hall_id:
                  type: integer
                  description: Номер зала, закреплённый за читателем
      responses:
        '201':
          description: Читатель успешно зарегистрирован
          content:
            text/plain:
              schema:
                type: string
                example: Читатель успешно зарегистрирован.
        '400':
          description: Некорректные входные данные
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Описание ошибки
                    example: ФИО читателя обязательно.
        '403':
          description: Недостаточно прав для регистрации читателя
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Описание ошибки
                    example: Доступ запрещен.
        '500':
          description: Внутренняя ошибка сервера
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Сообщение об ошибке
                    example: Произошла внутренняя ошибка сервера.

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT